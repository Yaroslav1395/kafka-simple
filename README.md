## Kafka Producer Configuration

–í –ø—Ä–æ–µ–∫—Ç–µ –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è Kafka –¥–ª—è –æ—Ç–ø—Ä–∞–≤–∫–∏ —Å–æ–æ–±—â–µ–Ω–∏–π. –ù–∏–∂–µ –ø—Ä–∏–≤–µ–¥–µ–Ω—ã –æ—Å–Ω–æ–≤–Ω—ã–µ –Ω–∞—Å—Ç—Ä–æ–π–∫–∏, —É–∫–∞–∑–∞–Ω–Ω—ã–µ –≤ `application.properties`

### üîß –ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è –ø—Ä–æ–¥—é—Å–µ—Ä–∞ (`spring.kafka.producer`)

| –ü–∞—Ä–∞–º–µ—Ç—Ä                                          | –ó–Ω–∞—á–µ–Ω–∏–µ                                                                                    | –û–ø–∏—Å–∞–Ω–∏–µ                                                                                                            |
|---------------------------------------------------|---------------------------------------------------------------------------------------------|---------------------------------------------------------------------------------------------------------------------|
| `bootstrap-servers`                               | `localhost:9092,localhost:9094`                                                             | –ê–¥—Ä–µ—Å–∞ Kafka-–±—Ä–æ–∫–µ—Ä–æ–≤, –∫ –∫–æ—Ç–æ—Ä—ã–º –ø–æ–¥–∫–ª—é—á–∞–µ—Ç—Å—è –ø—Ä–æ–¥—é—Å–µ—Ä. –ü–æ–¥–¥–µ—Ä–∂–∏–≤–∞–µ—Ç—Å—è –æ—Ç–∫–∞–∑–æ—É—Å—Ç–æ–π—á–∏–≤–æ—Å—Ç—å.                          |
| `key-serializer`                                  | `org.apache.kafka.common.serialization.StringSerializer`                                    | –°–µ—Ä–∏–∞–ª–∏–∑–∞—Ç–æ—Ä –¥–ª—è –∫–ª—é—á–µ–π —Å–æ–æ–±—â–µ–Ω–∏–π. –ò—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è —Å—Ç—Ä–æ–∫–æ–≤—ã–π —Å–µ—Ä–∏–∞–ª–∏–∑–∞—Ç–æ—Ä.                                             |
| `value-serializer`                                | `org.springframework.kafka.support.serializer.JsonSerializer`                               | –°–µ—Ä–∏–∞–ª–∏–∑–∞—Ç–æ—Ä –¥–ª—è –∑–Ω–∞—á–µ–Ω–∏–π —Å–æ–æ–±—â–µ–Ω–∏–π. –ò—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è —Å–µ—Ä–∏–∞–ª–∏–∑–∞—Ü–∏—è –≤ JSON.                                              |
| `acks`                                            | `all`                                                                                       | –ü—Ä–æ–¥—é—Å–µ—Ä –∂–¥–µ—Ç –ø–æ–¥—Ç–≤–µ—Ä–∂–¥–µ–Ω–∏—è –æ—Ç –≤—Å–µ—Ö —Ä–µ–ø–ª–∏–∫ –ø–µ—Ä–µ–¥ –∑–∞–≤–µ—Ä—à–µ–Ω–∏–µ–º –æ—Ç–ø—Ä–∞–≤–∫–∏. –û–±–µ—Å–ø–µ—á–∏–≤–∞–µ—Ç –Ω–∞–¥–µ–∂–Ω—É—é –¥–æ—Å—Ç–∞–≤–∫—É.              |
| `properties.delivery.timeout.ms`                  | `20000`                                                                                     | –ú–∞–∫—Å–∏–º–∞–ª—å–Ω–æ–µ –≤—Ä–µ–º—è (–≤ –º—Å), –≤ —Ç–µ—á–µ–Ω–∏–µ –∫–æ—Ç–æ—Ä–æ–≥–æ Kafka –¥–æ–ª–∂–Ω–∞ –¥–æ—Å—Ç–∞–≤–∏—Ç—å —Å–æ–æ–±—â–µ–Ω–∏–µ.                                     |
| `properties.linger.ms`                            | `0`                                                                                         | –í—Ä–µ–º—è –æ–∂–∏–¥–∞–Ω–∏—è –ø–µ—Ä–µ–¥ –æ—Ç–ø—Ä–∞–≤–∫–æ–π –ø–∞–∫–µ—Ç–∞ —Å–æ–æ–±—â–µ–Ω–∏–π. `0` –æ–∑–Ω–∞—á–∞–µ—Ç –º–≥–Ω–æ–≤–µ–Ω–Ω—É—é –æ—Ç–ø—Ä–∞–≤–∫—É.                                  |
| `properties.request.timeout.ms`                   | `10000`                                                                                     | –¢–∞–π–º–∞—É—Ç –∑–∞–ø—Ä–æ—Å–∞ –∫ Kafka –≤ –º—Å. –ï—Å–ª–∏ –∑–∞ —ç—Ç–æ –≤—Ä–µ–º—è –Ω–µ –ø–æ–ª—É—á–µ–Ω –æ—Ç–≤–µ—Ç ‚Äî –≤–æ–∑–Ω–∏–∫–∞–µ—Ç –æ—à–∏–±–∫–∞.                                |
| `properties.enable.idempotence`                   | `true`                                                                                      | –í–∫–ª—é—á–µ–Ω–∏–µ –∏–¥–µ–º–ø–æ—Ç–µ–Ω—Ç–Ω–æ—Å—Ç–∏ (–ø—Ä–µ–¥–æ—Ç–≤—Ä–∞—â–µ–Ω–∏–µ –¥—É–±–ª–∏—Ä—É—é—â–µ–π –æ—Ç–ø—Ä–∞–≤–∫–∏). –û–±–µ—Å–ø–µ—á–∏–≤–∞–µ—Ç exactly-once —Å–µ–º–∞–Ω—Ç–∏–∫—É.               |
| `properties.max.in.flight.request.per.connection` | `5`                                                                                         | –ú–∞–∫—Å–∏–º–∞–ª—å–Ω–æ–µ –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ —Å–æ–æ–±—â–µ–Ω–∏–π, –æ—Ç–ø—Ä–∞–≤–ª–µ–Ω–Ω—ã—Ö, –Ω–æ –µ—â—ë –Ω–µ –ø–æ–¥—Ç–≤–µ—Ä–∂–¥—ë–Ω–Ω—ã—Ö.                                          |
| `properties.spring.json.type.mapping`             | `productCreatedEvent:sakhno.springframework.ms.KafkaMicroservice.event.ProductCreatedEvent` | –°–≤—è–∑—ã–≤–∞–µ—Ç —Ç–∏–ø —Å–æ–±—ã—Ç–∏—è (`productCreatedEvent`) —Å Java-–∫–ª–∞—Å—Å–æ–º, –∫–æ—Ç–æ—Ä—ã–π –±—É–¥–µ—Ç –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å—Å—è –ø—Ä–∏ –¥–µ—Å–µ—Ä–∏–∞–ª–∏–∑–∞—Ü–∏–∏ JSON. |

### üí° –ü—Ä–∏–º–µ—á–∞–Ω–∏—è
- –ù–µ–∫–æ—Ç–æ—Ä—ã–µ –ø–∞—Ä–∞–º–µ—Ç—Ä—ã, —Ç–∞–∫–∏–µ –∫–∞–∫ `retries` –∏ `retry.backoff.ms`, –∑–∞–∫–æ–º–º–µ–Ω—Ç–∏—Ä–æ–≤–∞–Ω—ã, –Ω–æ –∏—Ö –º–æ–∂–Ω–æ –∞–∫—Ç–∏–≤–∏—Ä–æ–≤–∞—Ç—å –¥–ª—è –±–æ–ª–µ–µ —É—Å—Ç–æ–π—á–∏–≤–æ–π –¥–æ—Å—Ç–∞–≤–∫–∏ —Å–æ–æ–±—â–µ–Ω–∏–π –≤ —Å–ª—É—á–∞–µ –≤—Ä–µ–º–µ–Ω–Ω—ã—Ö —Å–±–æ–µ–≤.
- –ò–¥–µ–º–ø–æ—Ç–µ–Ω—Ç–Ω–æ—Å—Ç—å (`enable.idempotence`) —Ä–µ–∫–æ–º–µ–Ω–¥—É–µ—Ç—Å—è –≤–∫–ª—é—á–∞—Ç—å –ø—Ä–∏ `acks=all` –¥–ª—è –ø—Ä–µ–¥–æ—Ç–≤—Ä–∞—â–µ–Ω–∏—è –¥—É–±–ª–∏—Ä—É—é—â–∏—Ö —Å–æ–æ–±—â–µ–Ω–∏–π.
- `JsonSerializer` –ø–æ–∑–≤–æ–ª—è–µ—Ç —Å–µ—Ä–∏–∞–ª–∏–∑–æ–≤–∞—Ç—å —Å–ª–æ–∂–Ω—ã–µ –æ–±—ä–µ–∫—Ç—ã –∏ –ø–æ–¥–¥–µ—Ä–∂–∏–≤–∞–µ—Ç —Ç–∏–ø–∏–∑–∞—Ü–∏—é —á–µ—Ä–µ–∑ `type.mapping`.
- `spring.kafka.producer.properties.delivery.timeout.ms` –æ–∑–Ω–∞—á–∞–µ—Ç, —á—Ç–æ Kafka producer –±—É–¥–µ—Ç –ø—ã—Ç–∞—Ç—å—Å—è –¥–æ—Å—Ç–∞–≤–∏—Ç—å —Å–æ–æ–±—â–µ–Ω–∏–µ –º–∞–∫—Å–∏–º—É–º 20 —Å–µ–∫—É–Ω–¥, –≤–∫–ª—é—á–∞—è –≤—Å–µ –≤–æ–∑–º–æ–∂–Ω—ã–µ –ø–æ–ø—ã—Ç–∫–∏ —Ä–µ—Ç—Ä–∞–µ–≤, –∏ –µ—Å–ª–∏ –∑–∞ —ç—Ç–æ –≤—Ä–µ–º—è –¥–æ—Å—Ç–∞–≤–∫–∞ –Ω–µ –ø—Ä–æ–∏–∑–æ–π–¥—ë—Ç ‚Äî –±—É–¥–µ—Ç –≤—ã–±—Ä–æ—à–µ–Ω–æ –∏—Å–∫–ª—é—á–µ–Ω–∏–µ (timeout). –≠—Ç–æ –æ–±—â–∏–π –ª–∏–º–∏—Ç –≤—Ä–µ–º–µ–Ω–∏ –Ω–∞ –¥–æ—Å—Ç–∞–≤–∫—É –æ–¥–Ω–æ–≥–æ —Å–æ–æ–±—â–µ–Ω–∏—è. –û–Ω –≤–∫–ª—é—á–∞–µ—Ç –≤ —Å–µ–±—è: –í—Ä–µ–º—è –æ–∂–∏–¥–∞–Ω–∏—è –æ—Ç–≤–µ—Ç–∞ –æ—Ç Kafka (–Ω–∞—Å—Ç—Ä–∞–∏–≤–∞–µ—Ç—Å—è —á–µ—Ä–µ–∑ request.timeout.ms), –ó–∞–¥–µ—Ä–∂–∫–∏ –º–µ–∂–¥—É —Ä–µ—Ç—Ä–∞—è–º–∏ (retry.backoff.ms), –ö–æ–ª–∏—á–µ—Å—Ç–≤–æ –ø–æ–ø—ã—Ç–æ–∫ (retries) 
---

## –ü—Ä–∏–º–µ—Ä –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–∏ –≤ `application.properties`:

```properties
spring.kafka.producer.bootstrap-servers=localhost:9092,localhost:9094
spring.kafka.producer.key-serializer=org.apache.kafka.common.serialization.StringSerializer
spring.kafka.producer.value-serializer=org.springframework.kafka.support.serializer.JsonSerializer
spring.kafka.producer.acks=all
#spring.kafka.producer.retries=10
#spring.kafka.producer.properties.retry.backoff.ms=1000
spring.kafka.producer.properties.delivery.timeout.ms=20000
spring.kafka.producer.properties.linger.ms=0
spring.kafka.producer.properties.request.timeout.ms=10000
spring.kafka.producer.properties.enable.idempotence=true
spring.kafka.producer.properties.max.in.flight.request.per.connection=5
spring.kafka.producer.properties.spring.json.type.mapping=productCreatedEvent:sakhno.springframework.ms.KafkaMicroservice.event.ProductCreatedEvent
```


## Kafka Consumer Configuration

–í –ø—Ä–æ–µ–∫—Ç–µ –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è Kafka –¥–ª—è –ø–æ–ª—É—á–µ–Ω–∏—è —Å–æ–æ–±—â–µ–Ω–∏–π. –ù–∏–∂–µ –ø—Ä–∏–≤–µ–¥–µ–Ω—ã –æ—Å–Ω–æ–≤–Ω—ã–µ –Ω–∞—Å—Ç—Ä–æ–π–∫–∏, —É–∫–∞–∑–∞–Ω–Ω—ã–µ –≤ `application.properties`

### üîß –ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è –ø–æ—Ç—Ä–µ–±–∏—Ç–µ–ª—è (`spring.kafka.consumer`)

| –ü–∞—Ä–∞–º–µ—Ç—Ä                                      | –ó–Ω–∞—á–µ–Ω–∏–µ                                                                                           | –û–ø–∏—Å–∞–Ω–∏–µ                                                                                                                                  |
|-----------------------------------------------|----------------------------------------------------------------------------------------------------|-------------------------------------------------------------------------------------------------------------------------------------------|
| `bootstrap-servers`                           | `localhost:9092,localhost:9094`                                                                    | –ê–¥—Ä–µ—Å–∞ Kafka-–±—Ä–æ–∫–µ—Ä–æ–≤, –∫ –∫–æ—Ç–æ—Ä—ã–º –ø–æ–¥–∫–ª—é—á–∞–µ—Ç—Å—è –ø–æ—Ç—Ä–µ–±–∏—Ç–µ–ª—å. –ü–æ–¥–¥–µ—Ä–∂–∏–≤–∞–µ—Ç—Å—è –æ—Ç–∫–∞–∑–æ—É—Å—Ç–æ–π—á–∏–≤–æ—Å—Ç—å.                                             |
| `group-id`                                    | `product-created-events`                                                                           | –ò–¥–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ç–æ—Ä –≥—Ä—É–ø–ø—ã –ø–æ—Ç—Ä–µ–±–∏—Ç–µ–ª–µ–π. –í—Å–µ –ø–æ—Ç—Ä–µ–±–∏—Ç–µ–ª–∏ —Å –æ–¥–∏–Ω–∞–∫–æ–≤—ã–º `group-id` –±—É–¥—É—Ç –¥–µ–ª–∏—Ç—å –Ω–∞–≥—Ä—É–∑–∫—É –ø–æ —Ä–∞–∑–¥–µ–ª–µ–Ω–∏—é –ø–∞—Ä—Ç–∏—Ü–∏–π.                  |
| `properties.spring.json.trusted.packages`     | `sakhno.springframework.ms.EmailNotificationService.event`                                         | –£–∫–∞–∑—ã–≤–∞–µ—Ç —Å–ø–∏—Å–æ–∫ –¥–æ–≤–µ—Ä–µ–Ω–Ω—ã—Ö –ø–∞–∫–µ—Ç–æ–≤ –¥–ª—è –¥–µ—Å–µ—Ä–∏–∞–ª–∏–∑–∞—Ü–∏–∏ —Å–æ–æ–±—â–µ–Ω–∏–π. –≠—Ç–æ –Ω–µ–æ–±—Ö–æ–¥–∏–º–æ –¥–ª—è –∑–∞—â–∏—Ç—ã –æ—Ç –Ω–µ–∂–µ–ª–∞—Ç–µ–ª—å–Ω–æ–π –¥–µ—Å–µ—Ä–∏–∞–ª–∏–∑–∞—Ü–∏–∏ –∫–ª–∞—Å—Å–æ–≤.      |
| `properties.spring.json.type.mapping`         | `productCreatedEvent:sakhno.springframework.ms.EmailNotificationService.event.ProductCreatedEvent` | –°–≤—è–∑—ã–≤–∞–µ—Ç —Ç–∏–ø —Å–æ–±—ã—Ç–∏—è (`productCreatedEvent`) —Å Java-–∫–ª–∞—Å—Å–æ–º, –∫–æ—Ç–æ—Ä—ã–π –±—É–¥–µ—Ç –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å—Å—è –ø—Ä–∏ –¥–µ—Å–µ—Ä–∏–∞–ª–∏–∑–∞—Ü–∏–∏ JSON.                       |
| `auto-offset-reset`                           | `latest`                                                                                           | –£—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ—Ç, —á—Ç–æ –¥–µ–ª–∞—Ç—å, –µ—Å–ª–∏ —Å–º–µ—â–µ–Ω–∏–µ –Ω–µ –Ω–∞–π–¥–µ–Ω–æ: `latest` –æ–∑–Ω–∞—á–∞–µ—Ç —á—Ç–µ–Ω–∏–µ —Å–æ–æ–±—â–µ–Ω–∏–π, –Ω–∞—á–∏–Ω–∞—è —Å –ø–æ—Å–ª–µ–¥–Ω–µ–≥–æ –¥–æ—Å—Ç—É–ø–Ω–æ–≥–æ —Å–º–µ—â–µ–Ω–∏—è.        |

### üí° –ü—Ä–∏–º–µ—á–∞–Ω–∏—è
- `auto-offset-reset=latest` –æ–∑–Ω–∞—á–∞–µ—Ç, —á—Ç–æ –µ—Å–ª–∏ —Å–º–µ—â–µ–Ω–∏–µ –¥–ª—è –¥–∞–Ω–Ω–æ–≥–æ –ø–æ—Ç—Ä–µ–±–∏—Ç–µ–ª—è –Ω–µ –Ω–∞–π–¥–µ–Ω–æ, –æ–Ω –Ω–∞—á–Ω—ë—Ç —á—Ç–µ–Ω–∏–µ —Å–æ–æ–±—â–µ–Ω–∏–π —Å —Å–∞–º–æ–≥–æ –ø–æ—Å–ª–µ–¥–Ω–µ–≥–æ –¥–æ—Å—Ç—É–ø–Ω–æ–≥–æ —Å–º–µ—â–µ–Ω–∏—è. –ú–æ–∂–Ω–æ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å `earliest` –¥–ª—è —á—Ç–µ–Ω–∏—è —Å —Å–∞–º–æ–≥–æ –Ω–∞—á–∞–ª–∞.
- –ü–∞—Ä–∞–º–µ—Ç—Ä `properties.spring.json.trusted.packages` –æ–±–µ—Å–ø–µ—á–∏–≤–∞–µ—Ç –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å, –æ–≥—Ä–∞–Ω–∏—á–∏–≤–∞—è –¥–µ—Å–µ—Ä–∏–∞–ª–∏–∑–∞—Ü–∏—é —Ç–æ–ª—å–∫–æ —Ç–µ–º–∏ –∫–ª–∞—Å—Å–∞–º–∏, –∫–æ—Ç–æ—Ä—ã–µ –Ω–∞—Ö–æ–¥—è—Ç—Å—è –≤ —É–∫–∞–∑–∞–Ω–Ω—ã—Ö –ø–∞–∫–µ—Ç–∞—Ö.
- –î–ª—è –¥–µ—Å–µ—Ä–∏–∞–ª–∏–∑–∞—Ü–∏–∏ —Å–ª–æ–∂–Ω—ã—Ö –æ–±—ä–µ–∫—Ç–æ–≤ —á–µ—Ä–µ–∑ JSON –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è `JsonDeserializer`, –∫–æ—Ç–æ—Ä—ã–π —Ä–∞–±–æ—Ç–∞–µ—Ç —Å —Ç–∏–ø–∞–º–∏ Java-–∫–ª–∞—Å—Å–æ–≤, —É–∫–∞–∑–∞–Ω–Ω—ã–º–∏ –≤ `spring.kafka.consumer.properties.spring.json.type.mapping`.
- –ü–∞—Ä–∞–º–µ—Ç—Ä—ã –¥–µ—Å–µ—Ä–∏–∞–ª–∏–∑–∞—Ü–∏–∏ —á–µ—Ä–µ–∑ `spring.kafka.consumer.properties` –º–æ–≥—É—Ç –±—ã—Ç—å –Ω–∞—Å—Ç—Ä–æ–µ–Ω—ã –≤ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏ –æ—Ç —Å—Ç—Ä—É–∫—Ç—É—Ä—ã —Å–æ–æ–±—â–µ–Ω–∏–π –∏ —Ç–∏–ø–æ–≤ –¥–∞–Ω–Ω—ã—Ö, –∫–æ—Ç–æ—Ä—ã–µ –∏—Å–ø–æ–ª—å–∑—É—é—Ç—Å—è –≤ –ø—Ä–æ–µ–∫—Ç–µ.

## –ü—Ä–∏–º–µ—Ä –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–∏ –≤ `application.properties`:

```properties
spring.kafka.consumer.bootstrap-servers=localhost:9092,localhost:9094
spring.kafka.consumer.group-id=product-created-events
spring.kafka.consumer.properties.spring.json.trusted.packages=sakhno.springframework.ms.EmailNotificationService.event
spring.kafka.consumer.properties.spring.json.type.mapping=productCreatedEvent:sakhno.springframework.ms.EmailNotificationService.event.ProductCreatedEvent
spring.kafka.consumer.auto-offset-reset=latest
```



